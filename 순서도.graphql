                                 Start
                                   |
                                   V
                           +----------------+
                           | Load Settings  |
                           | (load_settings)|
                           +----------------+
                                   |
                                   V
                    +----------------------------+
                    | Is settings.json exists?   |
                    +----------------------------+
                        |                   |
                        | No                | Yes
                        V                   V
               +---------------+       +--------------------+
               | Create Empty  |       | Load Settings from |
               | Dictionary    |       | settings.json      |
               +---------------+       +--------------------+
                                   |
                                   V
                     +---------------------------+
                     | Create Main Window (root) |
                     +---------------------------+
                                   |
                                   V
                     +---------------------------+
                     | Set Title of Main Window  |
                     +---------------------------+
                                   |
                                   V
                          +------------------+
                          | Set Taskbar Icon |
                          | (iconphoto)      |
                          +------------------+
                                   |
                                   V
                     +--------------------------+
                     | Switch to Main Screen    |
                     | (switch_to_main_screen)  |
                     +--------------------------+
                                   |
                                   V
                     +------------------------------+
                     | Is "main_image" in settings? |
                     +------------------------------+
                           |                   |
                           | No                | Yes
                           V                   V
         +-----------------------+      +----------------------------------------+
         | Load Default Image    |      | Load Image from settings["main_image"] |
         | (main.png)            |      +----------------------------------------+
         +-----------------------+      
                                     |
                                     V
                     +----------------------------------+
                     | Display Main Image in Main Window|
                     +----------------------------------+
                                     |
                                     V
                          +------------------------+
                          | Is Main Image Clicked? |
                          +------------------------+
                           |                   |
                           | No                | Yes
                           V                   V
                     +-------------+      +--------------------------------+
                     | Do Nothing  |      | Switch to Macro Keyboard       |
                     |             |      | (switch_to_macro_keyboard)     |
                     +-------------+      +--------------------------------+
                                       |
                                       V
                         +--------------------------------+
                         | For Each Macro Key in Settings |
                         +--------------------------------+
                                       |
                                       V
                         +------------------------------+
                         | Create Button for Each Macro |
                         +------------------------------+
                                       |
                                       V
                             +---------------------+
                             | Is Button Clicked?  |
                             +---------------------+
                               |                 |
                               | No              | Yes
                               V                 V
                     +------------+          +--------------------- +
                     | Do Nothing |          | Run Macro (run_file) |
                     |            |          +--------------------- +
                     +------------+         
                                        |
                                        V
                               +-----------------+
                               | Is Macro a URL? |
                               +-----------------+
                                 |             |
                                 | Yes         | No
                                 V             V
          +--------------------------+       +-------------------------+
          | Open URL in Web Browser  |       | Open File with Default  |
          +--------------------------+       | Application             |
                                             +-------------------------+
                                         |
                                         V
                          +-------------------------------+
                          | Is Settings Button Clicked?   |
                          +-------------------------------+
                               |                   |
                               | No                | Yes
                               V                   V
                         +-------------+      +-----------------------+
                         | Do Nothing  |      | Open Settings Window  |
                         |             |      | (open_settings)       |
                         +-------------+      +-----------------------+
                                           |
                                           V
                            +---------------------------------+
                            | Is "Add Macro" Button Clicked?  |
                            +---------------------------------+
                                  |                   |
                                  | No                | Yes
                                  V                   V
                         +-------------+       +-----------------------+
                         | Do Nothing  |       | Add Macro (add_macro) |
                         |             |       +-----------------------+
                         +-------------+      
                                            |
                                            V
                                    +------------------+
                                    | Enter Macro Key  |
                                    +------------------+
                                            |
                                            V
                         +--------------------------------------+
                         | Open File Dialog (open_file_dialog)  |
                         +--------------------------------------+
                                            |
                                            V
                                +--------------------------+
                                | Is File or URL Selected? |
                                +--------------------------+
                                  |                     |
                                  | File                | URL
                                  V                     V
                         +------------------+      +---------- +
                         | Open File Dialog |      | Enter URL |
                         +------------------+      +---------- +
                                               |
                                               V
                                   +------------------------+
                                   | Save Macro in Settings |
                                   +------------------------+
                                               |
                                               V
                              +--------------------------------+
                              | Save Settings to settings.json |
                              +--------------------------------+
                                              |
                                              V
                                  +--------------------------+
                                  | Switch to Macro Keyboard |
                                  +--------------------------+
                                              |
                                              V
                              +-----------------------------------+
                              | Is "Delete Macro" Button Clicked? |
                              +-----------------------------------+
                               |                   |
                               | No                | Yes
                               V                   V
                         +-------------+      +----------------------------+
                         | Do Nothing  |      | Delete Macro (delete_macro)|
                         |             |      +----------------------------+
                         +-------------+
                                           |
                                           V
                                     +-----------------+
                                     | Enter Macro Key |
                                     +-----------------+
                                              |
                                              V
                                +---------------------------+
                                | Is Macro Key in Settings? |
                                +---------------------------+
                                   |                   |
                                   | No                | Yes
                                   V                   V
                         +------------+          +----------------------------+
                         | Do Nothing |          | Remove Macro from Settings |
                         |            |          +----------------------------+
                         +------------+         
                                             |
                                             V
                                +--------------------------------+
                                | Save Settings to settings.json |
                                +--------------------------------+
                                             |
                                             V
                                  +--------------------------+
                                  | Switch to Macro Keyboard |
                                  +--------------------------+
                                               |
                                               V
                              +----------------------------------------+
                              | Is "Change Main Image" Button Clicked? |
                              +----------------------------------------+
                                      |                   |
                                      | No                | Yes
                                      V                   V
                           +-------------+        +-------------------- +
                           | Do Nothing  |        | Change Main Image   |
                           |             |        | (change_main_image) |
                           +-------------+        +-------------------- +
                                             |
                                             V
                                    +------------------+
                                    | Open File Dialog |
                                    +------------------+
                                             |
                                             V
                                   +-----------------------+
                                   | Select New Main Image |
                                   +-----------------------+
                                             |
                                             V
                               +---------------------------------+
                               | Save New Main Image in Settings |
                               +---------------------------------+
                                             |
                                             V
                               +--------------------------------+
                               | Save Settings to settings.json |
                               +--------------------------------+
                                             |
                                             V
                                   +-----------------------+
                                   | Switch to Main Screen |
                                   +-----------------------+
                                             |
                                             V
                                            End